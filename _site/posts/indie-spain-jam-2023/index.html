<!DOCTYPE html>
<html data-theme="light" lang="es"><head><title>Mi aporte a la Indie Spain Jam 2023 - blog.nekerafa.dev</title><meta charset="utf-8"><link href="https://fonts.googleapis.com" rel="preconnect"><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"><link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@500;600;700&amp;family=Noto+Color+Emoji&amp;family=Nunito&amp;display=swap" rel="stylesheet"><link integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" referrerpolicy="no-referrer" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css" rel="stylesheet"><link href="/styles.css" rel="stylesheet"><meta content="2023-10-14T19:49:16.000Z" property="og:publish_time"><meta content="2023-12-09T10:35:51+0200" property="og:modified_time"><meta content="post-morten" property="og:tag"><meta content="castellano" property="og:tag"><meta content="article" property="og:type"><meta content="es" property="og:locale"><meta content="Mi aporte a la Indie Spain Jam 2023" property="og:title"><meta content="Se que iba a hablar antes de otros proyectos, pero el mes pasado estuve inmerso en la Indie Spain Jam 2023, por lo que quer√≠a hablar esta vez de mi √∫ltima‚Ä¶" property="og:description"><meta content="https://blog.nekerafa.dev/posts/indie-spain-jam-2023/" property="og:url"><meta content="summary" name="twitter:card"><meta content="@nekerafa" name="twitter:site"><meta content="Se que iba a hablar antes de otros proyectos, pero el mes pasado estuve inmerso en la Indie Spain Jam 2023, por lo que quer√≠a hablar esta vez de mi √∫ltima‚Ä¶" name="description"><meta content="Lume v2.0.3" name="generator"><link rel="icon" sizes="16x16 32x32" href="/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
</head><body><header class="container-fluid"><img alt="nekerafa.dev" class="logo" height="128px" src="/images/logo.webp" width="128px"><hgroup><h1><a href="/">hello world!</a></h1><p>Blog personal de Rafael Alcalde Azpiazu: programaci√≥n, cacharreo y sobre todo, pas√°ndomelo bien üò∫.</p></hgroup><nav><ul><li><a href="/tutorials">tutorials</a></li><li><a href="/about">about</a></li></ul></nav></header><nav><ul><li><a rel="me noopener" href="https://socials.nekerafa.dev" target="_blank"><i class="fa-solid fa-link"></i> Mis redes sociales</a></li><li><a href="/feed.xml"><i class="fa-solid fa-square-rss"></i> Feed RSS</a></li></ul></nav><main class="container"><h1>Mi aporte a la Indie Spain Jam 2023</h1><h2><span class="fa-solid fa-calendar-day"></span>S√°bado, 14 de octubre de 2023</h2><p><span class="badge">post-morten</span><span class="badge">castellano</span></p><p>Se que iba a hablar antes de otros proyectos, pero el mes pasado estuve inmerso en la Indie Spain Jam 2023, por lo que quer√≠a hablar esta vez de mi √∫ltima experiencia, adem√°s de lo que aprend√≠ en este evento, sobre todo porque, aunque no qued√≥ entre los 25 primeros, pude terminar otro proyecto del que se me ocurren muchas cosas para hacer.</p><p>Para la gente que no lo sepa, una Game Jam es un evento en el que desarrolladores, dise√±adores y dem√°s personas del mundo de los videojuegos se re√∫nen para, en un tiempo determinado, sacar un videojuego, ya sea de forma individual o por equipos. La idea es usar estos eventos para improvisar, aprender y sobre todo experimentar (de ah√≠ el t√©rmino jam, que hace consonancia a las Jam Sessions, que son eventos musicales para improvisar, sobre todo en el jazz). En esta ocasi√≥n me present√© a la Indie Spain Jam, que es una game jam anual (esta es su segunda entrega) hecha dentro de la organizaci√≥n de la IndieDevDay, la feria de videojuegos m√°s importante a nivel espa√±ol. A pesar de que cualquiera puede montar su stand y ofrecer un punto de promoci√≥n para alg√∫n proyecto, esta feria hace hincapi√© en, como su nombre indica, los videojuegos indie. Es por eso que el a√±o pasado, pensando en potenciar este espacio de promoci√≥n de "lo indie", organizaron su propia Game Jam.</p><p>Una de las cosas que distingue un evento de jam es que hay un tema central sobre el que gira el desarrollo. No es obligatorio, porque existen jams en las que el tema es libre, o que est√° fijado por el evento del que trata (si es una jam de juegos de gameboy, la idea es que tenga las limitaciones cercanas a las de un juego de gameboy, como puede ser la paleta de colores o el n√∫mero de sonidos que se pueden reproducir juntos). Este a√±o el tema de la Indie Spain Jam era "cae la noche", y a ver, te lo puedes tomar de forma literal o puedes empezar a armar una historia en donde la noche es la protagonista, al final el l√≠mite es contar con un scope que puedas realizar bien en una semana (a veces incluso menos, pero ya hablar√© de eso).</p><p>Y yo me lo tom√© literal. No es que caiga la noche, pero si parte de ella. Mi idea era hacer que la luna cayese contra la tierra, y, a ver, puede parecer un concepto sencillo: le pones f√≠sicas a la luna para que caiga a la tierra y listo... pero se me escapaba que ten√≠a que enfrentarme a un problema. Mi idea era imitar un poco un Angry Birds, con la principal mec√°nica de hacer que pudieras impulsar la luna y est√° trazara una par√°bola como estudiamos en f√≠sica del colegio. Pero claro, aqu√≠ no somos terraplanistas como la gente de Angry Birds. Mi tierra es redonda (es un juego 2D, se me olvid√≥ comentarlo), por lo que aqu√≠ encontr√© el problema.</p><p>Normalmente en los videojuegos, cuando aplicamos f√≠sicas suponemos que existe una fuerza de la gravedad que tira los objetos hacia abajo de la pantalla. Esta gravedad no tiene que coincidir con la gravedad terrestre, ya que, salvo que tu juego tenga un tema realista, este valor normalmente se ajusta con la idea de que en pantalla se muestre algo que sea divertido, jugable o incluso directamente se scripta (por ejemplo cuando tenemos plataformas de salto que tienen que llevar a una zona concreta del nivel). Aqu√≠ podr√≠amos incluso jugar con el prop√≥sito de game feel y a√±adir impulsos, momentos y dem√°s para hacer que el juego se sienta natural a pesar de no tener una gravedad como en la tierra. Como resumen, una de las cosas m√°s recurrentes en la literatura del dise√±o de videojuegos es realizar trampitas, pero que no se noten.</p><p>Pues con esta idea decid√≠ mirar a ver como modificar las f√≠sicas de Godot para mostrar algo que me convenciera, o al menos hacer algo que resolviera el problema. Revisando c√≥mo funciona el sistema de f√≠sicas, Godot tiene dos funciones principales que me pod√≠an servir para esto. La primera es <code>_physics_process()</code>, que es muy similar a la funci√≥n <code>FixedUpdate()</code> de Unity. Este callback se llama en el mismo frame donde se actualiza el motor de f√≠sicas, porque a diferencia de lo que se puede pensar, normalmente los motores de videojuegos actualizan las f√≠sicas a una duraci√≥n constante. Esto se realiza para que las colisiones se detecten siempre de forma determinista. En Godot viene configurado para que sea llamado a 0.016 segundos (60 veces por segundo). La cosa es que esta funci√≥n, aunque est√° sincronizada con la actualizaci√≥n de f√≠sicas, no permite una actualizaci√≥n correcta del estado f√≠sico del objeto porque, al menos en Godot, el sistema de f√≠sicas se ejecuta paralelamente en otro proceso independiente. Para estas cosas, si tu nodo deriva de un RigidBody, existe la funci√≥n <code>_integrate_forces()</code>, que nos permite modificar de forma segura el estado f√≠sico del nodo, aplicarle fuerzas, etc. Incluso con esta funci√≥n podr√≠amos hacer nuestras f√≠sicas custom en vez de usar la del motor de f√≠sicas si tambi√©n ponemos a true el atributo de custom_integrator. En mi caso me interesa cambiar c√≥mo funciona solo la gravedad, por lo que no voy a desactivarlo completamente.</p><p>Teniendo esto en cuenta la idea es establecer una fuerza radial que siempre apunte al centro del planeta. Podr√≠amos usar la funci√≥n de la gravedad para dos cuerpos para que el valor de esta fuerza tenga en cuenta la distancia y dem√°s, pero como ya dije antes, estamos aqu√≠ para hacer trampitas, y que el jugador mande la luna a velocidad de escape de la tierra no es que sea divertido, por lo que no lo voy a tener en cuenta. Para que afecte un poco eso de que que a mayor distancia atrae menos, si que le aplico esto, pero hasta una distancia m√°xima, a partir de ah√≠ siempre va a atraer a la tierra. Con todo esto, mi funci√≥n qued√≥ con el c√≥digo siguiente:</p><pre><code class="language-gdscript hljs"><span class="hljs-number">27</span>  <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">_integrate_forces</span>(<span class="hljs-title">state</span>):</span>
<span class="hljs-number">28</span>      <span class="hljs-keyword">var</span> direction = earth.global_position - global_position
<span class="hljs-number">29</span>      <span class="hljs-keyword">var</span> force = <span class="hljs-built_in">min</span>(<span class="hljs-built_in">max</span>(direction.length(), <span class="hljs-number">2048.0</span>), <span class="hljs-number">8192.0</span>)
<span class="hljs-number">30</span>      gravity = direction.normalized() * Constants.GRAVITY * force / <span class="hljs-number">2048.0</span>
<span class="hljs-number">31</span>      state.apply_central_force(gravity)
</code></pre><p>Luego, para que siempre se aplique esta funci√≥n, puse que el objeto tenga siempre gravedad 0, que es un par√°metro que se puede ajustar en el RigidBody. Adem√°s, lo bueno de poder saber c√≥mo interact√∫a la gravedad en el objeto es que se puede tambi√©n dise√±ar un sistema de predicci√≥n de donde va a acabar la luna, pero no lo voy a explicar en esta entrada porque est√° quedando bastante larga. Si quer√©is revisar m√°s cosas de como hice este proyecto, ten√©is todo el c√≥digo disponible en mi <a href="https://gitlab.com/NEKERAFA/indie-spain-jam-23"><i class="fa-brands fa-gitlab"></i> GitLab</a>.</p></main><footer class="container"><p>The content on this web is licensed under <a href="https://creativecommons.org/licenses/by/4.0" rel="noopener" target="_blank">Creative Commons Attribution 4.0 (CC BY 4.0) <i class="fa-brands fa-creative-commons"></i><i class="fa-brands fa-creative-commons-by"></i></a>.</p><p>See more information on <a href="/legal" rel="license">legal</a> page.</p><p class="centered">From Galicia üíô made with <a href="https://lume.land" rel="noopener" target="_blank">lume</a> üî• | Source code on <a href="https://github.com/NEKERAFA/nekerafa.dev" rel="noopener" target="_blank"><i class="fa-brands fa-github"></i> Github</a></p></footer></body></html>